BALANCE_FILE = 'balance.txt'
STARTING_BALANCE = 100.0

def read_balance
  if File.exist?(BALANCE_FILE)
    File.read(BALANCE_FILE).to_f
  else
    STARTING_BALANCE
  end
end

def write_balance(balance)
  File.write(BALANCE_FILE, balance.to_s)
end

def deposit(balance, amount)
  if amount <= 0
    puts 'Сумма должна быть больше нуля.'
  else
    balance += amount
    puts "Новый баланс: #{balance}"
  end
  balance
end

def withdraw(balance, amount)
  if amount <= 0
    puts 'Сумма должна быть больше нуля.'
  elsif amount > balance
    puts 'Недостаточно средств на счете.'
  else
    balance -= amount
    puts "Новый баланс: #{balance}"
  end
  balance
end

balance = read_balance

loop do
  puts 'Выберите действие:'
  puts 'D - внести деньги'
  puts 'W - вывести деньги'
  puts 'B - проверить баланс'
  puts 'Q - выйти'
  choice = gets.chomp.downcase

  case choice
  when 'd'
    print 'Введите сумму для внесения: '
    amount = gets.chomp.to_f
    balance = deposit(balance, amount)
  when 'w'
    print 'Введите сумму для вывода: '
    amount = gets.chomp.to_f
    balance = withdraw(balance, amount)
  when 'b'
    puts "Текущий баланс: #{balance}"
  when 'q'
    write_balance(balance)
    break
  else
    puts 'Неправильный ввод.'
  end
end
